#include <windows.h>
#include <Winuser.h>
#include <iostream>
#include <locale>

HWND hChildWnd1;
using namespace std; 
LRESULT CALLBACK WndProc(HWND, UINT, WPARAM, LPARAM);
 
int WINAPI WinMain(HINSTANCE hInstance,
HINSTANCE hPrevInstance,
LPTSTR lpCmdLine,
int nCmdShow)
{
char cname[]="Class";
char title[]="AE-05 Termocikl test NB";
MSG msg;
 
setlocale(LC_ALL, "Russian");
//структура для регистрации класса окон
WNDCLASS wc;
wc.style = 0;
wc.lpfnWndProc = (WNDPROC)WndProc;
wc.cbClsExtra = 0;
wc.cbWndExtra = 0;
wc.hInstance = hInstance;
wc.hIcon = LoadIcon(hInstance, (LPCTSTR)IDI_APPLICATION);
wc.hCursor = LoadCursor(NULL, IDC_ARROW);
wc.hbrBackground = (HBRUSH)(COLOR_WINDOW+1);
wc.lpszMenuName = 0;
wc.lpszClassName = cname;
//регестрируем класс
if(!RegisterClass(&wc)) return 0;
//создать окно
HWND hWnd = CreateWindow(cname, title, WS_OVERLAPPEDWINDOW,
298, 323, 300, 300, NULL, NULL, hInstance, NULL);
//проверим создалось ли окно
if(!hWnd)return 0;
//Создаем кнопку
HWND hWnd_button = CreateWindow("button", "PRESS ME", WS_CHILD | WS_VISIBLE | BS_PUSHBUTTON,
40, 40, 200, 200, hWnd, (HMENU)10000, hInstance, NULL);
//показать окно
ShowWindow(hWnd, nCmdShow);
//обновить содержимое окна
UpdateWindow(hWnd);
 
// Координаты консольного окна
COORD crd = {10, 10};
SMALL_RECT src = {0, 0, crd.X, crd.Y};
SetConsoleScreenBufferSize (GetStdHandle (STD_OUTPUT_HANDLE), crd);
SetConsoleWindowInfo (GetStdHandle (STD_OUTPUT_HANDLE), TRUE, &src);


//цикл обработки сообщений
while(GetMessage(&msg, NULL,0 ,0))
{
TranslateMessage(&msg);
DispatchMessage(&msg);
}
return 0;
};
 
 int i = 0;
//процедура окна
LRESULT CALLBACK WndProc(HWND hWnd, UINT message,WPARAM wParam, LPARAM lParam)
{
switch(message)
{

case WM_CREATE:
break;
case WM_DESTROY:
PostQuitMessage(0);
break;
case WM_PAINT:
break;
default:
return DefWindowProc(hWnd, message, wParam, lParam);
case WM_COMMAND:
        switch (wParam)
        {
        case 10000:
                                      
         //test 3.3.4
               Sleep(1000);              
         SetCursorPos(375, 290);
         mouse_event(MOUSEEVENTF_LEFTDOWN,0,0,0,0); // нажали левую кнопку мыши12
         mouse_event(MOUSEEVENTF_LEFTUP,0,0,0,0); // отпустили левую кнопку мыши
         
                     Sleep(2000);              
         SetCursorPos(760, 280);
         mouse_event(MOUSEEVENTF_LEFTDOWN,0,0,0,0); // нажали левую кнопку мыши13
         mouse_event(MOUSEEVENTF_LEFTUP,0,0,0,0); // отпустили левую кнопку мыши
         
               Sleep(54000);              
         SetCursorPos(760, 325);
         mouse_event(MOUSEEVENTF_LEFTDOWN,0,0,0,0); // нажали левую кнопку мыши14
         mouse_event(MOUSEEVENTF_LEFTUP,0,0,0,0); // отпустили левую кнопку мыши
         
         
         
         //test 3.3.11
        
                     Sleep(54000);     
         SetCursorPos(375, 510);
         mouse_event(MOUSEEVENTF_LEFTDOWN,0,0,0,0); // нажали левую кнопку мыши23
         mouse_event(MOUSEEVENTF_LEFTUP,0,0,0,0); // отпустили левую кнопку мыши
         
               Sleep(2000);              
         SetCursorPos(760, 280);
         mouse_event(MOUSEEVENTF_LEFTDOWN,0,0,0,0); // нажали левую кнопку мыши24
         mouse_event(MOUSEEVENTF_LEFTUP,0,0,0,0); // отпустили левую кнопку мыши
         
         
         // save protocol 
                            Sleep(18000);         
         SetCursorPos(954, 617);
         mouse_event(MOUSEEVENTF_LEFTDOWN,0,0,0,0); // нажали левую кнопку мыши35
         mouse_event(MOUSEEVENTF_LEFTUP,0,0,0,0); // отпустили левую кнопку мыши
         
                              Sleep(3000);              
         SetCursorPos(917, 505);
         mouse_event(MOUSEEVENTF_LEFTDOWN,0,0,0,0); // нажали левую кнопку мыши36
         mouse_event(MOUSEEVENTF_LEFTUP,0,0,0,0); // отпустили левую кнопку мыши
        
         // reset protocol 
                              Sleep(1000);              
      //   SetCursorPos(1060, 835);
        // mouse_event(MOUSEEVENTF_LEFTDOWN,0,0,0,0); // нажали левую кнопку мыши
        // mouse_event(MOUSEEVENTF_LEFTUP,0,0,0,0); // отпустили левую кнопку мыши
         




                              return 0;

                
            break;
        }
        break;
 
        // Обработка сообщения по умолчанию
    }

    return 0;
} 
